<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Educational Institute</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="logo.png" type="image/png">
    <style>
        :root {
            --primary-color: #2d6b6b;
            --secondary-color: #3a9d9d;
            --accent-color: #f8f9fa;
            --text-color: #333;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f6f9;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            overflow-x: hidden;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1030;
            height: 60px;
            border-bottom: 3px solid rgba(255, 255, 255, 0.1);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }

        .dashboard-sidebar {
            position: fixed;
            top: 60px;
            left: 0;
            height: calc(100vh - 60px);
            width: 260px;
            background: linear-gradient(180deg, #2c3e50, #34495e);
            padding-top: 20px;
            overflow-y: auto;
            z-index: 1020;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .dashboard-sidebar .nav-link {
            color: #bdc3c7;
            padding: 15px 25px;
            margin: 5px 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: 500;
            border-left: 4px solid transparent;
        }

        .dashboard-sidebar .nav-link.active,
        .dashboard-sidebar .nav-link:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: #ffffff;
            border-left-color: var(--secondary-color);
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(58, 157, 157, 0.3);
        }

        .dashboard-sidebar .nav-link i {
            width: 20px;
            text-align: center;
            margin-right: 10px;
            font-size: 1.1rem;
        }

        .dashboard-content {
            margin-left: 260px;
            margin-top: 60px;
            height: calc(100vh - 60px);
            display: flex;
            flex-direction: column;
            background-color: #f4f6f9;
            transition: margin-left 0.3s ease;
        }
        /* Teacher Subject Dropdown Styling */
        #timetableSubject option {
            padding: 8px 12px;
        }

        #timetableSubject option:disabled {
            color: #6c757d;
            font-weight: bold;
            background-color: #f8f9fa;
        }

        /* Loading state */
        #timetableSubject.loading {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="%23000" stroke-width="2" stroke-dasharray="30 10"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"/></circle></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
        }

        /* Stats Container - Fixed Height */
        .stats-container {
            flex-shrink: 0;
            background: #f4f6f9;
            padding: 15px 0px 0px 0px;
            border-bottom: 1px solid #eaeaea;
        }

        .stats-card {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            height: 100%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .stats-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        .stats-card .icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            background: linear-gradient(135deg, #e8f4f4, #ffffff);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            box-shadow: 0 4px 15px rgba(45, 107, 107, 0.2);
        }

        .stats-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stats-card p {
            color: #6c757d;
            font-weight: 500;
            margin: 0;
            font-size: 0.95rem;
        }

        /* Tabs Container - Fixed with Horizontal Scroll */
        .tabs-container {
            flex-shrink: 0;
            background: #ffffff;
            padding: 0 35px;
            border-bottom: 1px solid #dee2e6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            position: sticky;
            top: 0;
            z-index: 1010;
            overflow-x: auto;  /* यह line ADD करें */
            white-space: nowrap;  /* यह line ADD करें */
        }

        /* Scrollbar styling */
        .tabs-container::-webkit-scrollbar {
            height: 6px;
        }

        .tabs-container::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .tabs-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }

        .nav-tabs {
        border-bottom: none;
        margin-bottom: 0;
        gap: 5px;
        display: flex;
        flex-wrap: nowrap;  /* यह line ADD करें */
    }

        .nav-tabs .nav-link {
            border: none;
            border-bottom: 3px solid transparent;
            color: #495057;
            font-weight: 600;
            padding: 18px 25px;
            transition: all 0.3s ease;
            background: transparent;
            border-radius: 8px 8px 0 0;
            position: relative;
        }
        
        .nav-tabs .nav-link.active {
            border-bottom: 3px solid var(--primary-color);
            color: var(--primary-color);
            background: rgba(45, 107, 107, 0.05);
        }

        .nav-tabs .nav-link:hover {
            border-bottom-color: var(--secondary-color);
            color: var(--secondary-color);
            background: rgba(58, 157, 157, 0.05);
        }

        /* Tab Content Container - Scrollable */
        .tab-content-container {
            flex: 1;
            overflow-y: auto;
            padding: 0px 0px;
            background-color: #f4f6f9;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            margin-bottom: 15px;
            background: #ffffff;
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .card-header {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-bottom: 1px solid #eaeaea;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary-color);
            padding: 20px 25px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-radius: 15px 15px 0 0 !important;
        }

        .table-responsive {
        border-radius: 10px;
        overflow: auto;  /* "hidden" से "auto" करें */
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

        /* Table minimum width */
        .table-responsive table {
            min-width: 1000px;
        }

        .table {
            margin-bottom: 0;
        }

        .table thead th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px 12px;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table tbody tr {
            transition: all 0.2s ease;
            border-bottom: 1px solid #f1f3f4;
        }

        .table tbody tr:hover {
            background-color: #f8fdfd;
            transform: scale(1.01);
        }

        .table tbody td {
            padding: 15px 12px;
            vertical-align: middle;
            border: none;
            font-weight: 500;
        }

        .notification-panel {
            position: fixed;
            top: 60px;
            right: 0;
            width: 400px;
            height: calc(100vh - 60px);
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            box-shadow: -5px 0 25px rgba(0,0,0,0.1);
            z-index: 1040;
            padding: 25px;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            border-left: 1px solid #eaeaea;
        }

        .notification-panel.open {
            transform: translateX(0);
        }

        .notification-bell {
            position: relative;
            margin-right: 20px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .notification-bell:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: linear-gradient(135deg, var(--danger-color), #e74c3c);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.4);
        }

        .modal-content {
            border-radius: 20px;
            border: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-bottom: none;
            padding: 25px 30px;
        }

        .modal-header .modal-title {
            font-weight: 700;
            font-size: 1.3rem;
        }

        .modal-body {
            padding: 30px;
        }

        .modal-footer {
            border-top: 1px solid #eaeaea;
            padding: 20px 30px;
            background: #f8f9fa;
        }
        
        .form-control, .form-select {
            border-radius: 12px;
            padding: 12px 18px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.3rem rgba(45, 107, 107, 0.15);
            transform: translateY(-2px);
        }

        .form-label {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .btn-action {
            padding: 8px 12px;
            font-size: 0.85rem;
            margin: 0 3px;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-action:hover {
            transform: scale(1.1);
        }
        
        .sync-status {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 1000;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            display: none;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .badge-success {
            background: linear-gradient(135deg, var(--success-color), #20c997);
        }

        .badge-warning {
            background: linear-gradient(135deg, var(--warning-color), #fd7e14);
        }

        .badge-danger {
            background: linear-gradient(135deg, var(--danger-color), #e74c3c);
        }

        .badge-info {
            background: linear-gradient(135deg, var(--info-color), #2dc3e8);
        }

        .attendance-mark {
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 8px;
            display: inline-block;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .present {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #28a745;
        }

        .absent {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(45, 107, 107, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(45, 107, 107, 0.4);
        }

        .btn-sm {
            padding: 10px 18px;
            font-size: 0.9rem;
        }

        .search-box {
            max-width: 350px;
        }

        .search-box .form-control {
            border-radius: 25px;
            padding-left: 45px;
            background: #f8f9fa;
        }

        .search-box i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
            z-index: 5;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Enhanced attendance styling */
        .attendance-checkbox:checked + label {
            font-weight: 700;
            color: var(--success-color);
        }

        .present-badge {
            font-size: 0.8rem;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
        }

        /* Notification panel enhancements */
        .notification-item {
            border-left: 5px solid #dee2e6;
            transition: all 0.3s ease;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }

        .notification-item.high-priority {
            border-left-color: var(--danger-color);
            background: linear-gradient(135deg, #fff5f5, #ffffff);
        }

        .notification-item.medium-priority {
            border-left-color: var(--warning-color);
            background: linear-gradient(135deg, #fffbf0, #ffffff);
        }

        .notification-item.low-priority {
            border-left-color: var(--info-color);
            background: linear-gradient(135deg, #f0f9ff, #ffffff);
        }

        .notification-item:hover {
            background-color: #f8f9fa;
            transform: translateX(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.12);
        }

        /* Custom scrollbar for tab content */
        .tab-content-container::-webkit-scrollbar {
            width: 8px;
        }

        .tab-content-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .tab-content-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 4px;
        }

        .tab-content-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
        }

        /* Custom scrollbar for sidebar */
        .dashboard-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .dashboard-sidebar::-webkit-scrollbar-track {
            background: #2c3237;
        }

        .dashboard-sidebar::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 3px;
        }

        .dashboard-sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        

        @media (max-width: 768px) {
            .dashboard-sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
                transform: translateX(-100%);
            }
            
            .dashboard-sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .dashboard-content {
                margin-left: 0;
                margin-top: 60px;
                height: auto;
            }

            .stats-container,
            .tabs-container,
            .tab-content-container {
                padding: 15px;
            }
            
            .stats-card {
                margin-bottom: 15px;
            }

            .notification-panel {
                width: 100%;
            }
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 50px 20px;
            color: #6c757d;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #dee2e6;
            opacity: 0.7;
        }

        .empty-state p {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Table header sticky */
        .table thead th {
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        /* Card body padding adjustment */
        .card-body {
            padding: 0;
        }

        /* Fix for tab content height */
        .tab-pane {
            min-height: 100%;
        }

        /* Enhanced dropdown styling */
        .dropdown-menu {
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border: none;
            padding: 10px;
        }

        .dropdown-item {
            padding: 10px 15px;
            border-radius: 8px;
            margin: 2px 0;
            transition: all 0.3s ease;
        }

        .dropdown-item:hover {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            transform: translateX(5px);
        }

        /* Mobile menu button -*/
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            margin-right: 15px;
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            
            .dashboard-sidebar {
                transform: translateX(-100%);
            }
            
            .dashboard-sidebar.mobile-open {
                transform: translateX(0);
            }
        }

        /* Enhanced form styling */
        .form-check-input:checked {
            background-color: var(--success-color);
            border-color: var(--success-color);
        }

        .form-check-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(45, 107, 107, 0.25);
        }

        /* Progress bars for attendance */
        .attendance-progress {
            height: 8px;
            border-radius: 4px;
            background: #e9ecef;
            overflow: hidden;
        }

        .attendance-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--info-color));
            border-radius: 4px;
        }

        /* Hover effects for cards */
        .feature-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        /* Badge variations */
        .badge-online {
            background: linear-gradient(135deg, var(--success-color), #20c997);
        }

        .badge-offline {
            background: linear-gradient(135deg, #6c757d, #868e96);
        }

        .badge-busy {
            background: linear-gradient(135deg, var(--danger-color), #e74c3c);
        }

        /* Animation for notifications */
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-panel.open {
            animation: slideInRight 0.3s ease-out;
        }

        /* Print styles */
        @media print {
            .navbar, .dashboard-sidebar, .notification-panel, .sync-status {
                display: none !important;
            }
            
            .dashboard-content {
                margin: 0;
                height: auto;
            }
            
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
        /* Contact Messages Styling */
        .contact-messages-container {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .contact-messages-container table {
            margin-bottom: 0;
        }
        
        .contact-messages-container .table td {
            vertical-align: middle;
        }
        
        /* Status badges */
        .badge.bg-danger { background-color: #dc3545 !important; }
        .badge.bg-warning { background-color: #ffc107 !important; color: #000; }
        .badge.bg-info { background-color: #0dcaf0 !important; }
        .badge.bg-success { background-color: #198754 !important; }
        
        /* New message highlight */
        .table-warning {
            background-color: rgba(255, 193, 7, 0.1) !important;
        }
        /* Add to your existing CSS */
        .class-header-row {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .class-header-row:hover {
            background-color: #e9ecef !important;
        }
        
        .class-student-row {
            transition: all 0.3s ease;
        }
        
        .class-student-row:hover {
            background-color: #f8fdfd;
            transform: scale(1.01);
        }
        
        .student-avatar {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .student-avatar i {
            font-size: 1.5rem;
        }

        /* ADD ये CSS rules: */
        .class-header-row {
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #2d6b6b !important;
        }
        
        .class-header-row:hover {
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5) !important;
            transform: translateX(5px);
        }
        
        .fee-row {
            transition: all 0.3s ease;
            border-bottom: 1px solid #f1f3f4;
        }
        
        .fee-row:hover {
            background-color: #f8fdfd;
            transform: scale(1.01);
        }
        
        .total-summary-row {
            position: sticky;
            bottom: 0;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        /* Payment mode badges */
        .badge.bg-success { background: linear-gradient(135deg, #28a745, #20c997) !important; }
        .badge.bg-primary { background: linear-gradient(135deg, #0d6efd, #0dcaf0) !important; }
        .badge.bg-info { background: linear-gradient(135deg, #17a2b8, #2dc3e8) !important; }
        .badge.bg-warning { 
            background: linear-gradient(135deg, #ffc107, #fd7e14) !important; 
            color: #000 !important;
        }
        /* ADD ये CSS rules: */
        .bg-purple {
            background: linear-gradient(135deg, #6f42c1, #8a63d2) !important;
        }
        
        .btn-purple {
            background: linear-gradient(135deg, #6f42c1, #8a63d2) !important;
            border: none;
            color: white !important;
        }
        
        .btn-purple:hover {
            background: linear-gradient(135deg, #5a32a3, #7a52c7) !important;
        }
        
        .card-title {
            font-size: 1rem;
            font-weight: 600;
        }
        
        .modal-body .card {
            border: 1px solid #e9ecef;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .modal-body .card-body {
            padding: 1.25rem;
        }

        /* Attendance specific styles */
.class-header-row {
    cursor: pointer;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, #f8f9fa, #ffffff) !important;
    border-left: 4px solid var(--primary-color) !important;
}

.class-header-row:hover {
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5) !important;
    transform: translateX(5px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.attendance-record-row {
    transition: all 0.3s ease;
    border-left: 2px solid #e9ecef;
}

.attendance-record-row:hover {
    background-color: #f8fdfd;
    border-left-color: var(--secondary-color);
}

.attendance-badge {
    min-width: 80px;
    font-size: 0.85rem;
    padding: 6px 12px;
}

.attendance-checkbox {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.attendance-checkbox:checked {
    background-color: var(--success-color);
    border-color: var(--success-color);
}

/* Marks/Results Specific Styles */
.course-header-row {
    cursor: pointer;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, #f8f9fa, #ffffff) !important;
    border-left: 4px solid var(--info-color) !important;
}

.course-header-row:hover {
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5) !important;
    transform: translateX(5px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.marks-record-row {
    transition: all 0.3s ease;
    border-left: 2px solid #e9ecef;
}

.marks-record-row:hover {
    background-color: #f8fdfd;
    border-left-color: var(--info-color);
}

.bg-purple {
    background: linear-gradient(135deg, #6f42c1, #8a63d2) !important;
}

.text-purple {
    color: #6f42c1 !important;
}

.btn-purple {
    background: linear-gradient(135deg, #6f42c1, #8a63d2) !important;
    border: none;
    color: white !important;
}

.btn-purple:hover {
    background: linear-gradient(135deg, #5a32a3, #7a52c7) !important;
}


/* Fee Records Specific Styles */
.class-header-row {
    cursor: pointer;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, #f8f9fa, #ffffff) !important;
    border-left: 4px solid var(--success-color) !important;
}

.class-header-row:hover {
    background: linear-gradient(135deg, #e8f5e9, #f1f8e9) !important;
    transform: translateX(5px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.fee-record-row {
    transition: all 0.3s ease;
    border-left: 2px solid #e9ecef;
}

.fee-record-row:hover {
    background-color: #f8fdfd;
    border-left-color: var(--success-color);
}

.grand-total-row {
    position: sticky;
    bottom: 0;
    z-index: 100;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
}

/* Teacher Subjects Display */
.subject-badge {
    font-size: 0.85rem;
    padding: 5px 12px;
    border-radius: 20px;
    margin: 2px 4px 2px 0;
    display: inline-block;
    background: linear-gradient(135deg, #17a2b8, #138496);
    color: white;
    font-weight: 500;
    box-shadow: 0 2px 5px rgba(23, 162, 184, 0.3);
    transition: all 0.3s ease;
}

.subject-badge:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(23, 162, 184, 0.4);
}

/* Teacher actions button group */
.teacher-actions {
    display: flex;
    gap: 5px;
    justify-content: center;
}

.teacher-actions .btn {
    padding: 5px 10px;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.teacher-actions .btn:hover {
    transform: scale(1.1);
}

/* Subject list in modal */
.subject-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    border-bottom: 1px solid #e9ecef;
    transition: all 0.3s ease;
}

.subject-list-item:hover {
    background-color: #f8f9fa;
    transform: translateX(5px);
}

.subject-list-item .subject-name {
    font-weight: 600;
    color: #495057;
}

.subject-list-item .subject-meta {
    font-size: 0.85rem;
    color: #6c757d;
}

    </style>
</head>
<body>
    <!-- Header -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
            <a class="navbar-brand" href="#">
                <i class="fas fa-graduation-cap me-2"></i>AACEM Institute
            </a>
            <div class="d-flex align-items-center">
                <div class="notification-bell" onclick="toggleNotifications()">
                    <i class="fas fa-bell text-white"></i>
                    <span class="notification-badge" id="notificationCount">0</span>
                </div>
                <div class="btn-group ms-3">
                    <button class="btn btn-outline-light btn-sm" onclick="syncWithSupabase()">
                        <i class="fas fa-sync-alt me-1"></i> Sync Data
                    </button>
                    <button class="btn btn-outline-light btn-sm ms-2" onclick="logout()">
                        <i class="fas fa-sign-out-alt me-1"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Notification Panel -->
    <div class="notification-panel" id="notificationPanel">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="mb-0 text-primary">Notifications</h4>
            <div>
                <button class="btn btn-sm btn-outline-primary me-2" onclick="markAllNotificationsRead()">
                    <i class="fas fa-check-double me-1"></i> Mark All Read
                </button>
                <button class="btn btn-sm btn-outline-secondary" onclick="toggleNotifications()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div id="notificationList">
            <!-- Notifications will be loaded here -->
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 dashboard-sidebar" id="sidebar">
                <div class="text-center my-4">
                    <div class="bg-primary rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                        <i class="fas fa-user-shield text-white" style="font-size: 2rem;"></i>
                    </div>
                    <h5 class="text-white mb-1">Admin Panel</h5>
                    <small class="text-light opacity-75">Management System</small>
                </div>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showDashboard()">
                            <i class="fas fa-tachometer-alt"></i> Dashboard Overview
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#studentModal">
                            <i class="fas fa-user-plus"></i> New Student Admission
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#courseModal">
                            <i class="fas fa-book"></i> Course Management
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#attendanceModal">
                            <i class="fas fa-clipboard-check"></i> Mark Attendance
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#feeModal">
                            <i class="fas fa-money-bill-wave"></i> Fee Collection
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#teacherModal">
                            <i class="fas fa-chalkboard-teacher"></i> Faculty Management
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#marksModal">
                            <i class="fas fa-chart-line"></i> Exam Results
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#notificationModal">
                            <i class="fas fa-bullhorn"></i> Send Notification
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#reportModal">
                            <i class="fas fa-file-pdf"></i> Generate Reports
                        </a>
                    </li>
                    
                </ul>
                
                <!-- Sidebar Footer -->
                <div class="mt-auto p-4 text-center">
                    <small class="text-light opacity-50">
                        <i class="fas fa-heart text-danger"></i><br>
                        AACEM Institute<br>
                        Management System v2.0
                    </small>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 dashboard-content">
                <!-- Stats Cards -->
                <div class="stats-container">
                    <div class="row mb-4" id="dashboardStats">
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="icon"><i class="fas fa-user-graduate"></i></div>
                                <h3 class="stats-number" id="totalStudents">0</h3>
                                <p>Total Students</p>
                                <small class="text-muted">Currently Enrolled</small>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="icon"><i class="fas fa-chalkboard-teacher"></i></div>
                                <h3 class="stats-number" id="totalTeachers">0</h3>
                                <p>Faculty Members</p>
                                <small class="text-muted">Teaching Staff</small>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="icon"><i class="fas fa-book-open"></i></div>
                                <h3 class="stats-number" id="totalCourses">0</h3>
                                <p>Active Courses</p>
                                <small class="text-muted">Available Programs</small>
                            </div>
                        </div>
                        <!--<div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="icon"><i class="fas fa-money-bill-wave"></i></div>
                                <h3 class="stats-number" id="totalRevenue">₹0</h3>
                                <p>Total Revenue</p>
                                <small class="text-muted">All Time Collection</small>
                            </div>
                        </div>-->
                    </div>
                </div>

                <!-- Fixed Tabs Container -->
                <div class="tabs-container">
                    <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="students-tab" data-bs-toggle="tab" data-bs-target="#students" type="button" role="tab">
                                <i class="fas fa-users me-2"></i>Students
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="teachers-tab" data-bs-toggle="tab" data-bs-target="#teachers" type="button" role="tab">
                                <i class="fas fa-user-tie me-2"></i>Teachers
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="courses-tab" data-bs-toggle="tab" data-bs-target="#courses" type="button" role="tab">
                                <i class="fas fa-graduation-cap me-2"></i>Courses
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="fees-tab" data-bs-toggle="tab" data-bs-target="#fees" type="button" role="tab">
                                <i class="fas fa-credit-card me-2"></i>Fee Records
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="attendance-tab" data-bs-toggle="tab" data-bs-target="#attendance" type="button" role="tab">
                                <i class="fas fa-calendar-check me-2"></i>Attendance
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="marks-tab" data-bs-toggle="tab" data-bs-target="#marks" type="button" role="tab">
                                <i class="fas fa-chart-bar me-2"></i>Exam Results
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="pdfs-tab" data-bs-toggle="tab" data-bs-target="#pdfs" type="button" role="tab">
                                <i class="fas fa-file-pdf me-2"></i>Course PDFs
                            </button>
                        </li>
                        <!-- Syllabus Tab -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="syllabus-tab" data-bs-toggle="tab" data-bs-target="#syllabus" type="button" role="tab">
                                <i class="fas fa-book-open me-2"></i>Syllabus & Subjects
                            </button>
                        </li>
                        <!-- Time Table Tab -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="timetable-tab" data-bs-toggle="tab" data-bs-target="#timetable" type="button" role="tab">
                                <i class="fas fa-calendar-alt me-2"></i>Time Table
                            </button>
                        </li>
                        <!-- Section Management Tab -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="sections-tab" data-bs-toggle="tab" data-bs-target="#sections" type="button" role="tab">
                                <i class="fas fa-layer-group me-2"></i>Sections
                            </button>
                        </li>
                        <!-- Student Sections Tab -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="student-sections-tab" data-bs-toggle="tab" 
                                data-bs-target="#student-sections" type="button" role="tab">
                                <i class="fas fa-users-cog me-2"></i>Student Sections
                            </button>
                        </li>
                        <!-- Teacher-Section Mapping Tab -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="teacher-sections-tab" data-bs-toggle="tab" data-bs-target="#teacher-sections" type="button" role="tab">
                                <i class="fas fa-chalkboard-user me-2"></i>Teacher Sections
                            </button>
                        </li>
                        <!-- Contact Messages Tab - Add this in your nav tabs -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab">
                                <i class="fas fa-envelope me-2"></i> Contact Messages
                                <span id="contactMessageCount" class="badge bg-danger ms-2">0</span>
                            </button>
                        </li>
                        <!-- Add this tab to navigation -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="announcements-tab" data-bs-toggle="tab" data-bs-target="#announcements" type="button" role="tab">
                                <i class="fas fa-bullhorn me-2"></i>Announcements
                            </button>
                        </li>
                        <!-- Teacher Permissions Tab - Admin Dashboard mein add karo -->
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="teacher-permissions-tab" data-bs-toggle="tab" 
                                data-bs-target="#teacher-permissions" type="button" role="tab">
                                <i class="fas fa-user-shield me-2"></i>Teacher Permissions
                                <span class="badge bg-warning ms-2" id="pendingPermissionsCount">0</span>
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- Scrollable Content Area -->
                <div class="tab-content-container">
                    <div class="tab-content" id="dashboardTabsContent">
                        <!-- Students Tab -->
                        <div class="tab-pane fade show active" id="students" role="tabpanel">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-user-graduate me-2"></i>Student Management</h5>
                                    <div class="d-flex gap-2 align-items-center">
                                        <div class="search-box position-relative">
                                            <i class="fas fa-search"></i>
                                            <input type="text" class="form-control form-control-sm" placeholder="Search students by name, ID, or course..." id="studentSearch">
                                        </div>
                                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#studentModal">
                                            <i class="fas fa-plus me-1"></i> Add New
                                        </button>
                                        <button class="btn btn-success btn-sm" onclick="exportData('students')">
                                            <i class="fas fa-download me-1"></i> Export
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Name</th>
                                                    <th>Course</th>
                                                    <th>Join Date</th>
                                                    <th>Contact</th>
                                                    <th>Fee Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="studentsTableBody">
                                                <!-- Students data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Teachers Tab -->
                        <div class="tab-pane fade" id="teachers" role="tabpanel">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-user-tie me-2"></i>Faculty Management</h5>
                                    <div class="d-flex gap-2 align-items-center">
                                        <div class="search-box position-relative">
                                            <i class="fas fa-search"></i>
                                            <input type="text" class="form-control form-control-sm" placeholder="Search teachers by name, subject..." id="teacherSearch">
                                        </div>
                                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#teacherModal">
                                            <i class="fas fa-plus me-1"></i> Add New
                                        </button>
                                        <button class="btn btn-success btn-sm" onclick="exportData('teachers')">
                                            <i class="fas fa-download me-1"></i> Export
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Name</th>
                                                    <th>Subject</th>
                                                    <th>Join Date</th>
                                                    <th>Contact</th>
                                                    <th>Salary</th>
                                                    <th>Password</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="teachersTableBody">
                                                <!-- Teachers data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Teacher Permissions Tab Content -->
                        <!-- Teacher Permissions Tab Content -->
                        <div class="tab-pane fade" id="teacher-permissions" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4><i class="fas fa-user-shield me-2 text-primary"></i>Teacher Permissions</h4>
                                <div>
                                    <button class="btn btn-success" onclick="openGrantPermissionModal()">
                                        <i class="fas fa-plus me-1"></i> Grant Permission
                                    </button>
                                    <button class="btn btn-primary" onclick="loadTeacherPermissions()">
                                        <i class="fas fa-sync-alt me-1"></i> Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Stats Cards -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card border-primary">
                                        <div class="card-body text-center">
                                            <i class="fas fa-chalkboard-teacher fa-2x text-primary mb-2"></i>
                                            <h3 class="mb-0" id="totalTeachersWithPerm">0</h3>
                                            <small class="text-muted">Teachers</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-check-circle fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="activePermissions">0</h3>
                                            <small class="text-muted">Active</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-warning">
                                        <div class="card-body text-center">
                                            <i class="fas fa-clock fa-2x text-warning mb-2"></i>
                                            <h3 class="mb-0" id="expiringSoon">0</h3>
                                            <small class="text-muted">Expiring Soon</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-danger">
                                        <div class="card-body text-center">
                                            <i class="fas fa-times-circle fa-2x text-danger mb-2"></i>
                                            <h3 class="mb-0" id="expiredPermissions">0</h3>
                                            <small class="text-muted">Expired</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Permissions Table -->
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Permissions List
                                        <span class="badge bg-primary ms-2" id="permissionsCount">0</span>
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-dark">
                                                <tr>
                                                    <th>#</th>
                                                    <th>Teacher</th>
                                                    <th>Section</th>
                                                    <th>Course</th>
                                                    <th>Permissions</th>
                                                    <th>Expiry</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="permissionsTableBody">
                                                <tr>
                                                    <td colspan="8" class="text-center py-5">
                                                        <i class="fas fa-user-shield fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">Loading permissions...</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Grant Permission Modal -->
                        <div class="modal fade" id="grantPermissionModal" tabindex="-1">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-key me-2"></i>Grant Marks Permission
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="grantPermissionForm">
                                            <div class="mb-3">
                                                <label class="form-label">Select Teacher *</label>
                                                <select class="form-select" id="permissionTeacher" required>
                                                    <option value="">Loading teachers...</option>
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Select Section *</label>
                                                <select class="form-select" id="permissionSection" required>
                                                    <option value="">Loading sections...</option>
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-check-label">
                                                    <input type="checkbox" class="form-check-input" id="canUploadMarks" checked>
                                                    <i class="fas fa-chart-line text-primary me-1"></i> Can Upload Marks
                                                </label>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-check-label">
                                                    <input type="checkbox" class="form-check-input" id="canUploadPdfs" checked>
                                                    <i class="fas fa-file-pdf text-danger me-1"></i> Can Upload PDFs
                                                </label>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Permission Duration (Days) *</label>
                                                <input type="number" class="form-control" id="permissionDays" 
                                                    value="30" min="1" max="365" required>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-success" onclick="grantMarksPermission()">
                                            <i class="fas fa-check me-1"></i> Grant Permission
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Courses Tab -->
                        <div class="tab-pane fade" id="courses" role="tabpanel">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>Course Management</h5>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#courseModal">
                                            <i class="fas fa-plus me-1"></i> Add New
                                        </button>
                                        <button class="btn btn-success btn-sm" onclick="exportData('courses')">
                                            <i class="fas fa-download me-1"></i> Export
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Code</th>
                                                    <th>Course Name</th>
                                                    <th>Duration</th>
                                                    <th>Fee</th>
                                                    <th>Category</th>
                                                    <th>Students</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="coursesTableBody">
                                                <!-- Courses data will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Fee Records Tab - Section Wise -->
                        <div class="tab-pane fade" id="fees" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-money-bill-wave me-2 text-success"></i>Section-wise Fee Records</h4>
                                    <p class="text-muted mb-0">View and manage fee collections by course and section</p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#feeModal">
                                        <i class="fas fa-plus me-2"></i>Record Payment
                                    </button>
                                    <button class="btn btn-success" onclick="exportSectionFees()">
                                        <i class="fas fa-download me-2"></i>Export
                                    </button>
                                    <button class="btn btn-info" onclick="refreshSectionFees()">
                                        <i class="fas fa-sync-alt me-2"></i>Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Statistics Cards - UPDATED (Total Fee hata diya) -->
                            <div class="row mb-4">
                                <div class="col-md-4"> <!-- Pehle 3 columns the, ab 4 mein se 3 kar diye -->
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-rupee-sign fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="totalFeeCollected">₹0</h3>
                                            <small class="text-muted">Total Collected</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card border-primary">
                                        <div class="card-body text-center">
                                            <i class="fas fa-receipt fa-2x text-primary mb-2"></i>
                                            <h3 class="mb-0" id="totalFeePayments">0</h3>
                                            <small class="text-muted">Total Payments</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card border-info">
                                        <div class="card-body text-center">
                                            <i class="fas fa-layer-group fa-2x text-info mb-2"></i>
                                            <h3 class="mb-0" id="feeSectionsCount">0</h3>
                                            <small class="text-muted">Sections</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-end">
                                        <div class="col-md-3">
                                            <label class="form-label fw-semibold">
                                                <i class="fas fa-book me-1"></i>Filter by Course
                                            </label>
                                            <select class="form-select" id="feeCourseFilter" onchange="handleFeeCourseChange()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <label class="form-label fw-semibold">
                                                <i class="fas fa-layer-group me-1"></i>Filter by Section
                                            </label>
                                            <select class="form-select" id="feeSectionFilter" onchange="filterSectionFees()" disabled>
                                                <option value="">All Sections</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <label class="form-label fw-semibold">
                                                <i class="fas fa-calendar me-1"></i>Date Range
                                            </label>
                                            <select class="form-select" id="feeDateFilter" onchange="filterSectionFees()">
                                                <option value="">All Time</option>
                                                <option value="today">Today</option>
                                                <option value="week">This Week</option>
                                                <option value="month">This Month</option>
                                                <option value="year">This Year</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <label class="form-label fw-semibold">
                                                <i class="fas fa-search me-1"></i>Search
                                            </label>
                                            <input type="text" class="form-control" id="feeSearch" 
                                                placeholder="Receipt No, Student..." onkeyup="searchSectionFees()">
                                        </div>
                                        
                                        <div class="col-md-12 text-end mt-3">
                                            <button class="btn btn-sm btn-outline-secondary" onclick="resetFeeFilters()">
                                                <i class="fas fa-undo me-1"></i> Reset Filters
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Fee Records Table -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Fee Records
                                        <span class="badge bg-success ms-2" id="feeRecordsCount">0</span>
                                    </h5>
                                    <div>
                                        <span class="badge bg-primary me-2" id="totalAmountDisplay">Total: ₹0</span>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>#</th>
                                                    <th>Receipt No</th>
                                                    <th>Student</th>
                                                    <th>Course</th>
                                                    <th>Section</th>
                                                    <th>Amount</th>
                                                    <th>Date</th>
                                                    <th>Mode</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="feeRecordsTableBody">
                                                <tr>
                                                    <td colspan="10" class="text-center py-5">
                                                        <i class="fas fa-money-bill-wave fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">Loading fee records...</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="card-footer bg-white">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">
                                            Showing <span id="feeShowingCount">0</span> of <span id="feeTotalCount">0</span> records
                                        </small>
                                        <small class="text-muted">
                                            <i class="fas fa-info-circle me-1"></i>
                                            Total: <strong id="footerTotalAmount">₹0</strong>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- View Fee Details Modal -->
                        <div class="modal fade" id="viewFeeModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-receipt me-2"></i>Fee Receipt Details
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body" id="viewFeeContent">
                                        <!-- Content will be loaded here -->
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button type="button" class="btn btn-success" onclick="printReceipt()">Print Receipt</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Syllabus Tab Content -->
                        <div class="tab-pane fade" id="syllabus" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-book-open me-2 text-primary"></i>Course Syllabus Management</h4>
                                    <p class="text-muted mb-0">Manage course syllabus, subjects, and topics</p>
                                </div>
                                <div>
                                    <button class="btn btn-success me-2" onclick="showAddSyllabusModal()">
                                        <i class="fas fa-plus me-2"></i>Add New Syllabus
                                    </button>
                                    <button class="btn btn-primary" onclick="refreshSyllabus()">
                                        <i class="fas fa-sync-alt me-2"></i>Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Statistics Cards -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card border-primary">
                                        <div class="card-body text-center">
                                            <i class="fas fa-book-open fa-2x text-primary mb-2"></i>
                                            <h3 class="mb-0" id="totalSyllabus">0</h3>
                                            <small class="text-muted">Total Syllabus</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-graduation-cap fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="coursesWithSyllabus">0</h3>
                                            <small class="text-muted">Courses with Syllabus</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-warning">
                                        <div class="card-body text-center">
                                            <i class="fas fa-list fa-2x text-warning mb-2"></i>
                                            <h3 class="mb-0" id="totalSubjects">0</h3>
                                            <small class="text-muted">Total Subjects</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-info">
                                        <div class="card-body text-center">
                                            <i class="fas fa-clock fa-2x text-info mb-2"></i>
                                            <h3 class="mb-0" id="totalHours">0</h3>
                                            <small class="text-muted">Total Hours</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-4">
                                            <label class="form-label">Filter by Course:</label>
                                            <select class="form-select" id="syllabusCourseFilter" onchange="filterSyllabus()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Search Syllabus:</label>
                                            <input type="text" class="form-control" id="searchSyllabus" 
                                                placeholder="Search by title or description..." onkeyup="searchSyllabus()">
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="showActiveOnly" checked 
                                                    onchange="filterSyllabus()">
                                                <label class="form-check-label" for="showActiveOnly">
                                                    Show Active Syllabus Only
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Syllabus Table -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Syllabus List
                                        <span class="badge bg-primary ms-2" id="syllabusCount">0</span>
                                    </h5>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="exportSyllabus()">
                                            <i class="fas fa-download me-1"></i>Export
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover" id="syllabusTable">
                                            <thead class="table-light">
                                                <tr>
                                                    <th width="5%">#</th>
                                                    <th width="15%">Course</th>
                                                    <th width="25%">Syllabus Title</th>
                                                    <th width="20%">Description</th>
                                                    <th width="10%">Duration</th>
                                                    <th width="10%">Subjects</th>
                                                    <th width="10%">Status</th>
                                                    <th width="15%" class="text-center">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="syllabusTableBody">
                                                <!-- Data will be loaded here -->
                                                <tr>
                                                    <td colspan="8" class="text-center py-5">
                                                        <i class="fas fa-book-open fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">No syllabus found. Click "Add New Syllabus" to create one.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Add/Edit Syllabus Modal -->
                        <div class="modal fade" id="syllabusModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-plus me-2"></i>Add New Syllabus
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="syllabusForm">
                                            <input type="hidden" id="editSyllabusId">
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Course *</label>
                                                    <select class="form-select" id="syllabusCourse" required>
                                                        <option value="">Select course...</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Syllabus Title *</label>
                                                    <input type="text" class="form-control" id="syllabusTitle" 
                                                        placeholder="e.g., Complete Course Syllabus" required>
                                                </div>
                                            </div>

                                            <div class="mb-3">
                                                <label class="form-label">Description</label>
                                                <textarea class="form-control" id="syllabusDescription" rows="2" 
                                                        placeholder="Brief description of the syllabus..."></textarea>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Total Duration (Hours) *</label>
                                                    <input type="number" class="form-control" id="syllabusDuration" 
                                                        min="1" max="500" value="40" required>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Status</label>
                                                    <select class="form-select" id="syllabusStatus">
                                                        <option value="active">Active</option>
                                                        <option value="inactive">Inactive</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <!-- Subjects Section -->
                                            <div class="card mb-3">
                                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                                    <h6 class="mb-0">
                                                        <i class="fas fa-list me-2"></i>Subjects & Topics
                                                    </h6>
                                                    <button type="button" class="btn btn-sm btn-success" onclick="addSubjectRow()">
                                                        <i class="fas fa-plus me-1"></i> Add Subject
                                                    </button>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-responsive">
                                                        <table class="table table-bordered" id="subjectsTable">
                                                            <thead class="table-light">
                                                                <tr>
                                                                    <th width="5%">#</th>
                                                                    <th width="40%">Subject Name *</th>
                                                                    <th width="20%">Duration (Hrs)</th>
                                                                    <th width="30%">Topics</th>
                                                                    <th width="5%">Action</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="subjectsTableBody">
                                                                <tr class="subject-row">
                                                                    <td>1</td>
                                                                    <td>
                                                                        <input type="text" class="form-control form-control-sm subject-name" 
                                                                            placeholder="Enter subject name" required>
                                                                    </td>
                                                                    <td>
                                                                        <input type="number" class="form-control form-control-sm subject-duration" 
                                                                            min="1" max="100" value="4">
                                                                    </td>
                                                                    <td>
                                                                        <input type="text" class="form-control form-control-sm subject-topics" 
                                                                            placeholder="e.g., Basics, Theory, Practical">
                                                                    </td>
                                                                    <td class="text-center">
                                                                        <button type="button" class="btn btn-sm btn-danger" onclick="removeSubjectRow(this)" disabled>
                                                                            <i class="fas fa-trash"></i>
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-success" onclick="saveSyllabus()">
                                            <i class="fas fa-save me-1"></i> Save Syllabus
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Attendance Tab - Replace this entire tab content -->
                        <div class="tab-pane fade" id="attendance" role="tabpanel">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-calendar-check me-2"></i>Section Attendance Records</h5>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#attendanceModal">
                                            <i class="fas fa-plus me-1"></i> Mark Attendance
                                        </button>
                                        <button class="btn btn-success btn-sm" onclick="exportSectionAttendance()">
                                            <i class="fas fa-download me-1"></i> Export
                                        </button>
                                        <button class="btn btn-info btn-sm" onclick="loadSectionAttendanceRecords()">
                                            <i class="fas fa-sync-alt me-1"></i> Refresh
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <!-- Filters -->
                                    <div class="row mb-3">
                                        <div class="col-md-4">
                                            <select class="form-select" id="filterCourse" onchange="filterAttendanceByCourse()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <select class="form-select" id="filterSection" onchange="filterAttendanceBySection()">
                                                <option value="">All Sections</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="date" class="form-control" id="filterDate" onchange="filterAttendanceByDate()">
                                        </div>
                                    </div>
                                    
                                    <!-- Table -->
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Course</th>
                                                    <th>Section</th>
                                                    <th>Date</th>
                                                    <th>Subject</th>
                                                    <th>Present/Absent</th>
                                                    <th>Percentage</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="attendanceTableBody">
                                                <tr>
                                                    <td colspan="8" class="text-center py-4">
                                                        <i class="fas fa-calendar-times fa-3x text-muted mb-3"></i>
                                                        <p>No attendance records found</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Time Table Tab Content -->
                        <div class="tab-pane fade" id="timetable" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-calendar-alt me-2 text-primary"></i>Time Table Management</h4>
                                    <p class="text-muted mb-0">Manage class schedules and time tables</p>
                                </div>
                                <div>
                                    <button class="btn btn-success me-2" onclick="showAddTimetableModal()">
                                        <i class="fas fa-plus me-2"></i>Add Entry
                                    </button>
                                    <button class="btn btn-primary" onclick="refreshTimetable()">
                                        <i class="fas fa-sync-alt me-2"></i>Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-4">
                                            <label class="form-label">Filter by Course:</label>
                                            <select class="form-select" id="timetableCourseFilter" onchange="filterTimetable()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Filter by Day:</label>
                                            <select class="form-select" id="timetableDayFilter" onchange="filterTimetable()">
                                                <option value="">All Days</option>
                                                <option value="Monday">Monday</option>
                                                <option value="Tuesday">Tuesday</option>
                                                <option value="Wednesday">Wednesday</option>
                                                <option value="Thursday">Thursday</option>
                                                <option value="Friday">Friday</option>
                                                <option value="Saturday">Saturday</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="showActiveTimetableOnly" checked 
                                                    onchange="filterTimetable()">
                                                <label class="form-check-label" for="showActiveTimetableOnly">
                                                    Show Active Entries Only
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Timetable Display -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Time Table Entries
                                        <span class="badge bg-primary ms-2" id="timetableCount">0</span>
                                    </h5>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="exportTimetable()">
                                        <i class="fas fa-download me-1"></i>Export
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover" id="timetableTable">
                                            <thead class="table-dark">
                                                <tr>
                                                    <th>#</th>
                                                    <th>Day</th>
                                                    <th>Time</th>
                                                    <th>Course</th>
                                                    <th>Subject</th>
                                                    <th>Teacher</th>
                                                    <th>Room</th>
                                                    <th>Status</th>
                                                    <th class="text-center">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="timetableTableBody">
                                                <tr>
                                                    <td colspan="9" class="text-center py-5">
                                                        <i class="fas fa-calendar-alt fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">No timetable entries found. Click "Add Entry" to create one.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Messages Content - Add this in your tab content -->
                        <div class="tab-pane fade" id="contact" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4><i class="fas fa-envelope me-2"></i> Contact Messages</h4>
                                <div class="btn-group">
                                    <button class="btn btn-outline-primary btn-sm" onclick="loadContactMessages()">
                                        <i class="fas fa-sync-alt me-1"></i> Refresh
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteAllReadMessages()">
                                        <i class="fas fa-trash me-1"></i> Clear Read
                                    </button>
                                </div>
                            </div>
                        
                            <!-- Filter Buttons -->
                            <div class="row mb-3">
                                <div class="col-md-12">
                                    <div class="btn-group btn-group-sm" role="group">
                                        <button type="button" class="btn btn-outline-primary active" onclick="filterMessages('all')">
                                            All Messages
                                        </button>
                                        <button type="button" class="btn btn-outline-danger" onclick="filterMessages('new')">
                                            New <span id="newCount" class="badge bg-danger ms-1">0</span>
                                        </button>
                                        <button type="button" class="btn btn-outline-warning" onclick="filterMessages('read')">
                                            Read
                                        </button>
                                        <button type="button" class="btn btn-outline-info" onclick="filterMessages('replied')">
                                            Replied
                                        </button>
                                        <button type="button" class="btn btn-outline-success" onclick="filterMessages('resolved')">
                                            Resolved
                                        </button>
                                    </div>
                                </div>
                            </div>
                        
                            <!-- Messages Container -->
                            <div class="card">
                                <div class="card-body">
                                    <div id="contactMessagesContainer" class="contact-messages-container">
                                        <div class="text-center py-5">
                                            <div class="spinner-border text-primary mb-3" role="status">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                            <p>Loading contact messages...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- PDFs Tab Content - Section Wise -->
                        <div class="tab-pane fade" id="pdfs" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-file-pdf me-2 text-danger"></i>Section Study Materials</h4>
                                    <p class="text-muted mb-0">Upload and manage section-wise PDFs for students</p>
                                </div>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#uploadPdfModal">
                                    <i class="fas fa-upload me-2"></i>Upload PDF
                                </button>
                            </div>

                            <!-- PDF Statistics Cards -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card border-danger">
                                        <div class="card-body text-center">
                                            <i class="fas fa-file-pdf fa-2x text-danger mb-2"></i>
                                            <h3 class="mb-0" id="totalPdfsCount">0</h3>
                                            <small class="text-muted">Total PDFs</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-info">
                                        <div class="card-body text-center">
                                            <i class="fas fa-layer-group fa-2x text-info mb-2"></i>
                                            <h3 class="mb-0" id="coursesWithPdfsCount">0</h3>
                                            <small class="text-muted">Courses with PDFs</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-users fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="sectionsWithPdfsCount">0</h3>
                                            <small class="text-muted">Sections with PDFs</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-warning">
                                        <div class="card-body text-center">
                                            <i class="fas fa-clock fa-2x text-warning mb-2"></i>
                                            <h3 class="mb-0" id="recentPdfsCount">0</h3>
                                            <small class="text-muted">Last 7 Days</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-4">
                                            <label class="form-label">Filter by Course:</label>
                                            <select class="form-select" id="pdfCourseFilter" onchange="filterSectionPdfs()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Filter by Section:</label>
                                            <select class="form-select" id="pdfSectionFilter" onchange="filterSectionPdfs()" disabled>
                                                <option value="">All Sections</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Search:</label>
                                            <input type="text" class="form-control" id="pdfSearch" 
                                                placeholder="Search by title..." onkeyup="searchSectionPdfs()">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- PDFs List -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Section-wise PDFs
                                        <span class="badge bg-primary ms-2" id="pdfListCount">0</span>
                                    </h5>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="refreshSectionPdfs()">
                                            <i class="fas fa-sync-alt me-1"></i> Refresh
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="pdfListContainer" class="row">
                                        <!-- PDFs will be loaded here -->
                                        <div class="col-12 text-center py-5">
                                            <i class="fas fa-file-pdf fa-4x text-muted mb-3"></i>
                                            <p class="text-muted">No PDFs uploaded yet. Click "Upload PDF" to get started.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sections Tab Content -->
                        <div class="tab-pane fade" id="sections" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-layer-group me-2 text-primary"></i>Section Management</h4>
                                    <p class="text-muted mb-0">Manage course sections and student allocation</p>
                                </div>
                                <div>
                                    <button class="btn btn-success" onclick="showAddSectionModal()">
                                        <i class="fas fa-plus me-2"></i>Add New Section
                                    </button>
                                    <button class="btn btn-primary" onclick="refreshSections()">
                                        <i class="fas fa-sync-alt me-2"></i>Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Statistics Cards -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card border-primary">
                                        <div class="card-body text-center">
                                            <i class="fas fa-layer-group fa-2x text-primary mb-2"></i>
                                            <h3 class="mb-0" id="totalSections">0</h3>
                                            <small class="text-muted">Total Sections</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-users fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="studentsInSections">0</h3>
                                            <small class="text-muted">Students Allocated</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-warning">
                                        <div class="card-body text-center">
                                            <i class="fas fa-graduation-cap fa-2x text-warning mb-2"></i>
                                            <h3 class="mb-0" id="coursesWithSections">0</h3>
                                            <small class="text-muted">Courses with Sections</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-info">
                                        <div class="card-body text-center">
                                            <i class="fas fa-percentage fa-2x text-info mb-2"></i>
                                            <h3 class="mb-0" id="avgCapacity">0%</h3>
                                            <small class="text-muted">Avg Capacity</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-4">
                                            <label class="form-label">Filter by Course:</label>
                                            <select class="form-select" id="sectionCourseFilter" onchange="filterSections()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Search Section:</label>
                                            <input type="text" class="form-control" id="searchSection" 
                                                placeholder="Search..." onkeyup="searchSections()">
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="showActiveOnlySections" checked 
                                                    onchange="filterSections()">
                                                <label class="form-check-label">Show Active Only</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Sections Table -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Sections List
                                        <span class="badge bg-primary ms-2" id="sectionsCount">0</span>
                                    </h5>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="exportSections()">
                                        <i class="fas fa-download me-1"></i>Export
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-light">
                                                <tr>
                                                    <th width="5%">#</th>
                                                    <th width="15%">Course</th>
                                                    <th width="10%">Section</th>
                                                    <th width="15%">Capacity</th>
                                                    <th width="10%">Students</th>
                                                    <th width="10%">Utilization</th>
                                                    <th width="10%">Status</th>
                                                    <th width="25%" class="text-center">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="sectionsTableBody">
                                                <tr>
                                                    <td colspan="8" class="text-center py-5">
                                                        <i class="fas fa-layer-group fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">Loading sections...</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Teacher-Section Mapping Tab Content -->
                        <div class="tab-pane fade" id="teacher-sections" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-chalkboard-user me-2 text-primary"></i>Teacher-Section Mapping</h4>
                                    <p class="text-muted mb-0">Assign teachers to sections and subjects</p>
                                </div>
                                <div>
                                    <button class="btn btn-success" onclick="showAssignTeacherModal()">
                                        <i class="fas fa-plus me-2"></i>Assign Teacher
                                    </button>
                                    <button class="btn btn-primary" onclick="refreshTeacherMappings()">
                                        <i class="fas fa-sync-alt me-2"></i>Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Teacher Mappings Table -->
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Teacher Assignments
                                        <span class="badge bg-primary ms-2" id="mappingsCount">0</span>
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-light">
                                                <tr>
                                                    <th width="5%">#</th>
                                                    <th width="20%">Teacher</th>
                                                    <th width="15%">Course</th>
                                                    <th width="10%">Section</th>
                                                    <th width="20%">Subject</th>
                                                    <th width="15%">Assigned Date</th>
                                                    <th width="15%" class="text-center">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="teacherMappingsTableBody">
                                                <tr>
                                                    <td colspan="7" class="text-center py-5">
                                                        <i class="fas fa-chalkboard-user fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">Loading teacher assignments...</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ==================== STUDENT SECTIONS TAB - PRODUCTION READY ==================== -->
                        <div class="tab-pane fade" id="student-sections" role="tabpanel">
                            
                            <!-- Page Header -->
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h3 class="mb-1">
                                        <i class="fas fa-users-cog me-2 text-primary"></i>
                                        Student Section Assignment
                                    </h3>
                                    <p class="text-muted mb-0">
                                        <i class="fas fa-info-circle me-1"></i>
                                        Assign students to sections for organized management of PDFs, Marks, and Attendance
                                    </p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-success" onclick="openBulkAssignModal()">
                                        <i class="fas fa-users-cog me-1"></i> Bulk Assign
                                    </button>
                                    <button class="btn btn-info" onclick="openSectionWiseView()">
                                        <i class="fas fa-layer-group me-1"></i> View by Section
                                    </button>
                                    <button class="btn btn-warning" onclick="showUnassignedOnly()">
                                        <i class="fas fa-exclamation-triangle me-1"></i> Unassigned
                                    </button>
                                    <button class="btn btn-primary" onclick="refreshStudentSections()">
                                        <i class="fas fa-sync-alt me-1"></i> Refresh
                                    </button>
                                </div>
                            </div>

                            <!-- Statistics Cards -->
                            <div class="row g-3 mb-4">
                                <div class="col-md-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <div class="mb-3">
                                                <i class="fas fa-users fa-3x text-primary"></i>
                                            </div>
                                            <h2 class="mb-1 fw-bold" id="totalStudentsForSections">0</h2>
                                            <p class="text-muted mb-0">Total Students</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <div class="mb-3">
                                                <i class="fas fa-check-circle fa-3x text-success"></i>
                                            </div>
                                            <h2 class="mb-1 fw-bold text-success" id="assignedStudents">0</h2>
                                            <p class="text-muted mb-0">Assigned to Sections</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <div class="mb-3">
                                                <i class="fas fa-exclamation-circle fa-3x text-warning"></i>
                                            </div>
                                            <h2 class="mb-1 fw-bold text-warning" id="unassignedStudents">0</h2>
                                            <p class="text-muted mb-0">Not Assigned</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <div class="mb-3">
                                                <i class="fas fa-chart-pie fa-3x text-info"></i>
                                            </div>
                                            <h2 class="mb-1 fw-bold text-info" id="assignmentPercentage">0%</h2>
                                            <p class="text-muted mb-0">Assignment Rate</p>
                                            <div class="progress mt-2" style="height: 6px;">
                                                <div class="progress-bar bg-info" id="assignmentProgressBar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Course-wise Breakdown -->
                            <div class="card border-0 shadow-sm mb-4">
                                <div class="card-header bg-white border-bottom">
                                    <h6 class="mb-0">
                                        <i class="fas fa-chart-bar me-2"></i>Course-wise Assignment Summary
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="courseBreakdownContainer">
                                        <div class="text-center py-3">
                                            <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                                            <span class="ms-2 text-muted">Loading breakdown...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters Row -->
                            <div class="row g-3 align-items-end">
                                <div class="col-md-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-book me-1"></i>Filter by Course
                                    </label>
                                    <select class="form-select" id="studentSectionCourseFilter">
                                        <option value="">All Courses</option>
                                    </select>
                                </div>
                                
                                <!-- NEW: Section Filter -->
                                <div class="col-md-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-layer-group me-1"></i>Filter by Section
                                    </label>
                                    <select class="form-select" id="studentSectionSectionFilter">
                                        <option value="">All Sections</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-2">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-filter me-1"></i>Status
                                    </label>
                                    <select class="form-select" id="studentSectionStatusFilter">
                                        <option value="">All Students</option>
                                        <option value="assigned">✓ Assigned</option>
                                        <option value="unassigned">✗ Not Assigned</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-search me-1"></i>Search
                                    </label>
                                    <input type="text" class="form-control" id="searchStudentSections" 
                                        placeholder="Search by name, ID, email...">
                                </div>
                                
                                <!-- Reset Button -->
                                <div class="col-md-12 text-end mt-2">
                                    <button class="btn btn-sm btn-outline-secondary" id="resetFiltersBtn" onclick="resetAllFilters()">
                                        <i class="fas fa-undo me-1"></i> Reset Filters
                                    </button>
                                </div>
                            </div>

                            <!-- Students Table -->
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white border-bottom">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fas fa-list me-2"></i>Student List
                                            <span class="badge bg-primary ms-2" id="studentSectionsCount">0</span>
                                        </h6>
                                        <div>
                                            <span class="badge bg-success me-2">
                                                <i class="fas fa-check me-1"></i>
                                                <span id="displayedAssigned">0</span> Assigned
                                            </span>
                                            <span class="badge bg-warning text-dark">
                                                <i class="fas fa-times me-1"></i>
                                                <span id="displayedUnassigned">0</span> Unassigned
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th width="5%">#</th>
                                                    <th width="12%">
                                                        <i class="fas fa-id-badge me-1"></i>Student ID
                                                    </th>
                                                    <th width="20%">
                                                        <i class="fas fa-user me-1"></i>Name
                                                    </th>
                                                    <th width="18%">
                                                        <i class="fas fa-envelope me-1"></i>Email
                                                    </th>
                                                    <th width="12%">
                                                        <i class="fas fa-phone me-1"></i>Phone
                                                    </th>
                                                    <th width="10%">
                                                        <i class="fas fa-book me-1"></i>Course
                                                    </th>
                                                    <th width="13%">
                                                        <i class="fas fa-layer-group me-1"></i>Section
                                                    </th>
                                                    <th width="10%" class="text-center">
                                                        <i class="fas fa-cog me-1"></i>Actions
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody id="studentSectionsTableBody">
                                                <tr>
                                                    <td colspan="8" class="text-center py-5">
                                                        <div class="spinner-border text-primary mb-3" role="status"></div>
                                                        <p class="text-muted">Loading students...</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="card-footer bg-white border-top">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">
                                            Showing <strong id="showingCount">0</strong> of <strong id="totalCount">0</strong> students
                                        </small>
                                        <small class="text-muted">
                                            <i class="fas fa-info-circle me-1"></i>
                                            Click on "Assign" to assign students to sections
                                        </small>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- ==================== ASSIGN SECTION MODAL ==================== -->
                        <div class="modal fade" id="assignSectionModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-primary text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-user-plus me-2"></i>Assign Student to Section
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="assignSectionForm">
                                            <input type="hidden" id="assignStudentId">
                                            
                                            <!-- Student Info Card -->
                                            <div class="alert alert-info border-info">
                                                <h6 class="alert-heading">
                                                    <i class="fas fa-user me-2"></i>Student Information
                                                </h6>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <p class="mb-2">
                                                            <strong>Name:</strong> 
                                                            <span id="assignStudentNameDisplay"></span>
                                                        </p>
                                                        <p class="mb-0">
                                                            <strong>Student ID:</strong> 
                                                            <span id="assignStudentIdDisplay" class="badge bg-dark"></span>
                                                        </p>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <p class="mb-2">
                                                            <strong>Course:</strong> 
                                                            <span id="assignStudentCourseDisplay" class="badge bg-primary"></span>
                                                        </p>
                                                        <p class="mb-0">
                                                            <strong>Current Section:</strong> 
                                                            <span id="assignStudentCurrentSection" class="badge bg-warning">Not Assigned</span>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <input type="hidden" id="assignStudentName">
                                            <input type="hidden" id="assignStudentCourse">
                                            
                                            <!-- Section Selection -->
                                            <div class="mb-3">
                                                <label class="form-label fw-semibold">
                                                    <i class="fas fa-layer-group me-1"></i>
                                                    Select Section *
                                                </label>
                                                <select class="form-select form-select-lg" id="studentSectionSelect" required>
                                                    <option value="">Choose section...</option>
                                                </select>
                                                <div class="form-text">
                                                    <i class="fas fa-info-circle me-1"></i>
                                                    Available sections for this course. Full sections are disabled.
                                                </div>
                                            </div>

                                            <!-- Section Info (shown when section selected) -->
                                            <div id="selectedSectionInfo" style="display: none;" class="card bg-light border-0 mb-3">
                                                <div class="card-body">
                                                    <h6 class="card-title">
                                                        <i class="fas fa-info-circle me-2"></i>Section Details
                                                    </h6>
                                                    <div class="row small">
                                                        <div class="col-md-6">
                                                            <p class="mb-1"><strong>Section:</strong> <span id="sectionNameInfo"></span></p>
                                                            <p class="mb-0"><strong>Teacher:</strong> <span id="sectionTeacherInfo"></span></p>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <p class="mb-1"><strong>Capacity:</strong> <span id="sectionCapacityInfo"></span></p>
                                                            <p class="mb-0"><strong>Schedule:</strong> <span id="sectionScheduleInfo"></span></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Important Notes -->
                                            <div class="alert alert-warning border-warning mb-0">
                                                <h6 class="alert-heading">
                                                    <i class="fas fa-lightbulb me-2"></i>Important
                                                </h6>
                                                <ul class="mb-0 small">
                                                    <li>Student will appear in this section's attendance, marks, and PDFs</li>
                                                    <li>Student will receive section-specific announcements</li>
                                                    <li>Can be reassigned to a different section anytime</li>
                                                    <li>Section teacher can manage this student (if assigned)</li>
                                                </ul>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                            <i class="fas fa-times me-1"></i>Cancel
                                        </button>
                                        <button type="button" class="btn btn-primary btn-lg" onclick="saveStudentSectionAssignment()">
                                            <i class="fas fa-save me-1"></i>Assign to Section
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ==================== BULK ASSIGN MODAL ==================== -->
                        <div class="modal fade" id="bulkAssignModal" tabindex="-1">
                            <div class="modal-dialog modal-xl">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-users-cog me-2"></i>Bulk Section Assignment
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="alert alert-info border-info">
                                            <i class="fas fa-info-circle me-2"></i>
                                            <strong>Bulk Assignment:</strong> Automatically assign all unassigned students from a course to the selected section (respects section capacity).
                                        </div>

                                        <div class="row mb-4">
                                            <div class="col-md-6">
                                                <label class="form-label fw-semibold">
                                                    <i class="fas fa-book me-1"></i>Select Course *
                                                </label>
                                                <select class="form-select form-select-lg" id="bulkAssignCourse" onchange="loadSectionsForBulkAssign(this.value)">
                                                    <option value="">Choose course...</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label fw-semibold">
                                                    <i class="fas fa-layer-group me-1"></i>Select Section *
                                                </label>
                                                <select class="form-select form-select-lg" id="bulkAssignSection" onchange="showBulkPreview()">
                                                    <option value="">Choose course first...</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Preview Container -->
                                        <div id="bulkAssignPreview">
                                            <div class="text-center text-muted py-5">
                                                <i class="fas fa-hand-pointer fa-4x mb-3 opacity-50"></i>
                                                <p class="lead">Select course and section to see preview</p>
                                            </div>
                                        </div>

                                        <!-- Students Preview Table -->
                                        <div id="bulkAssignStudentsTable" style="display: none;">
                                            <hr>
                                            <h6 class="mb-3">
                                                <i class="fas fa-list me-2"></i>Students to be Assigned:
                                                <span class="badge bg-primary ms-2" id="bulkStudentCount">0</span>
                                            </h6>
                                            <div class="table-responsive" style="max-height: 350px; overflow-y: auto;">
                                                <table class="table table-sm table-hover table-bordered">
                                                    <thead class="table-light sticky-top">
                                                        <tr>
                                                            <th width="5%">#</th>
                                                            <th width="20%">Student ID</th>
                                                            <th width="30%">Name</th>
                                                            <th width="30%">Email</th>
                                                            <th width="15%">Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="bulkAssignStudentsList">
                                                        <!-- Students loaded here -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                            <i class="fas fa-times me-1"></i>Cancel
                                        </button>
                                        <button type="button" class="btn btn-success btn-lg" onclick="executeBulkAssign()" id="bulkAssignBtn" disabled>
                                            <i class="fas fa-users-cog me-1"></i>Assign All Students
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ==================== SECTION-WISE VIEW MODAL ==================== -->
                        <div class="modal fade" id="sectionWiseViewModal" tabindex="-1">
                            <div class="modal-dialog modal-xl">
                                <div class="modal-content">
                                    <div class="modal-header bg-info text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-layer-group me-2"></i>Section-wise Student View
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div id="sectionWiseContent">
                                            <div class="text-center py-5">
                                                <div class="spinner-border text-primary mb-3" role="status"></div>
                                                <p class="text-muted">Loading section-wise data...</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ==================== REMOVE CONFIRMATION MODAL ==================== -->
                        <div class="modal fade" id="removeConfirmModal" tabindex="-1">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header bg-danger text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-exclamation-triangle me-2"></i>Confirm Removal
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <input type="hidden" id="removeStudentId">
                                        <p class="mb-0">
                                            Are you sure you want to remove <strong id="removeStudentName"></strong> from their current section?
                                        </p>
                                        <div class="alert alert-warning mt-3 mb-0">
                                            <small>
                                                <i class="fas fa-info-circle me-1"></i>
                                                This will remove the student from section-specific attendance, marks, and PDFs access.
                                            </small>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-danger" onclick="confirmRemoveFromSection()">
                                            <i class="fas fa-trash me-1"></i>Remove from Section
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ==================== ANNOUNCEMENTS TAB CONTENT ==================== -->
                        <div class="tab-pane fade" id="announcements" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4><i class="fas fa-bullhorn me-2 text-warning"></i>Announcements Management</h4>
                                <div>
                                    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createAnnouncementModal">
                                        <i class="fas fa-plus me-1"></i> Create Announcement
                                    </button>
                                    <button class="btn btn-primary" onclick="refreshAnnouncements()">
                                        <i class="fas fa-sync-alt me-1"></i> Refresh
                                    </button>
                                </div>
                            </div>
                        
                            <!-- Statistics Cards -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card border-warning">
                                        <div class="card-body text-center">
                                            <i class="fas fa-bullhorn fa-2x text-warning mb-2"></i>
                                            <h3 class="mb-0" id="totalAnnouncements">0</h3>
                                            <small class="text-muted">Total Announcements</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-check-circle fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="activeAnnouncements">0</h3>
                                            <small class="text-muted">Active</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-danger">
                                        <div class="card-body text-center">
                                            <i class="fas fa-exclamation-circle fa-2x text-danger mb-2"></i>
                                            <h3 class="mb-0" id="urgentAnnouncements">0</h3>
                                            <small class="text-muted">Urgent</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-info">
                                        <div class="card-body text-center">
                                            <i class="fas fa-calendar-day fa-2x text-info mb-2"></i>
                                            <h3 class="mb-0" id="recentAnnouncements">0</h3>
                                            <small class="text-muted">This Week</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        
                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-3">
                                            <label class="form-label">Filter by Target:</label>
                                            <select class="form-select" id="announcementTargetFilter" onchange="filterAnnouncements()">
                                                <option value="">All</option>
                                                <option value="all">General (All)</option>
                                                <option value="course">Course Specific</option>
                                                <option value="section">Section Specific</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Filter by Priority:</label>
                                            <select class="form-select" id="announcementPriorityFilter" onchange="filterAnnouncements()">
                                                <option value="">All Priorities</option>
                                                <option value="urgent">Urgent</option>
                                                <option value="high">High</option>
                                                <option value="normal">Normal</option>
                                                <option value="low">Low</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Filter by Status:</label>
                                            <select class="form-select" id="announcementStatusFilter" onchange="filterAnnouncements()">
                                                <option value="">All</option>
                                                <option value="active">Active Only</option>
                                                <option value="inactive">Inactive Only</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Search:</label>
                                            <input type="text" class="form-control" id="searchAnnouncement" 
                                                placeholder="Search..." onkeyup="searchAnnouncements()">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        
                            <!-- Announcements Table -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>All Announcements
                                        <span class="badge bg-warning ms-2" id="announcementsCount">0</span>
                                    </h5>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="exportAnnouncements()">
                                        <i class="fas fa-download me-1"></i>Export
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle">
                                            <thead class="table-dark">
                                                <tr>
                                                    <th width="5%">#</th>
                                                    <th width="20%">Title</th>
                                                    <th width="25%">Message</th>
                                                    <th width="10%">Target</th>
                                                    <th width="10%">Priority</th>
                                                    <th width="10%">Date Range</th>
                                                    <th width="8%">Status</th>
                                                    <th width="12%" class="text-center">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="announcementsTableBody">
                                                <tr>
                                                    <td colspan="8" class="text-center py-5">
                                                        <i class="fas fa-bullhorn fa-3x text-muted mb-3"></i>
                                                        <p class="text-muted">Loading announcements...</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Create Announcement Modal -->
                        <div class="modal fade" id="createAnnouncementModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-bullhorn me-2"></i>Create New Announcement
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="createAnnouncementForm">
                                            <div class="mb-3">
                                                <label class="form-label">Announcement Title *</label>
                                                <input type="text" class="form-control" id="announcementTitle" 
                                                    placeholder="e.g., New MCA Batch Starting" required>
                                            </div>
                        
                                            <div class="mb-3">
                                                <label class="form-label">Message *</label>
                                                <textarea class="form-control" id="announcementMessage" rows="4"
                                                    placeholder="e.g., MCA new batch will start from 18-02-2026. All students are requested to be present on time." required></textarea>
                                            </div>
                        
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label class="form-label">Target Audience *</label>
                                                    <select class="form-select" id="announcementTarget" onchange="handleAnnouncementTarget()" required>
                                                        <option value="all">All Students</option>
                                                        <option value="course">Specific Course</option>
                                                        <option value="section">Specific Section</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">Priority *</label>
                                                    <select class="form-select" id="announcementPriority" required>
                                                        <option value="normal">Normal</option>
                                                        <option value="high">High</option>
                                                        <option value="urgent">Urgent</option>
                                                        <option value="low">Low</option>
                                                    </select>
                                                </div>
                                            </div>
                        
                                            <div class="row mb-3" id="announcementTargetDetails" style="display: none;">
                                                <div class="col-md-6">
                                                    <label class="form-label">Select Course</label>
                                                    <select class="form-select" id="announcementCourse" onchange="loadSectionsForAnnouncement(this.value)">
                                                        <option value="">Choose course...</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6" id="announcementSectionDiv" style="display: none;">
                                                    <label class="form-label">Select Section</label>
                                                    <select class="form-select" id="announcementSection">
                                                        <option value="">Choose section...</option>
                                                    </select>
                                                </div>
                                            </div>
                        
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label class="form-label">Start Date</label>
                                                    <input type="date" class="form-control" id="announcementStartDate">
                                                    <small class="form-text text-muted">When to start showing this announcement</small>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">End Date</label>
                                                    <input type="date" class="form-control" id="announcementEndDate">
                                                    <small class="form-text text-muted">When to stop showing this announcement</small>
                                                </div>
                                            </div>
                        
                                            <div class="alert alert-info">
                                                <i class="fas fa-lightbulb me-2"></i>
                                                <strong>Example:</strong> "MCA new batch will start from 18-02-2026"
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-success" onclick="createAnnouncement()">
                                            <i class="fas fa-save me-1"></i>Create Announcement
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- View Announcement Modal -->
                        <div class="modal fade" id="viewAnnouncementModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-info text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-eye me-2"></i>Announcement Details
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body" id="announcementDetailsContent">
                                        <!-- Details loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Edit Announcement Modal -->
                        <div class="modal fade" id="editAnnouncementModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-warning text-dark">
                                        <h5 class="modal-title">
                                            <i class="fas fa-edit me-2"></i>Edit Announcement
                                        </h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="editAnnouncementForm">
                                            <input type="hidden" id="editAnnouncementId">
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Announcement Title *</label>
                                                <input type="text" class="form-control" id="editAnnouncementTitle" required>
                                            </div>
                        
                                            <div class="mb-3">
                                                <label class="form-label">Message *</label>
                                                <textarea class="form-control" id="editAnnouncementMessage" rows="4" required></textarea>
                                            </div>
                        
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label class="form-label">Target Audience *</label>
                                                    <select class="form-select" id="editAnnouncementTarget" required>
                                                        <option value="all">All Students</option>
                                                        <option value="course">Specific Course</option>
                                                        <option value="section">Specific Section</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">Priority *</label>
                                                    <select class="form-select" id="editAnnouncementPriority" required>
                                                        <option value="normal">Normal</option>
                                                        <option value="high">High</option>
                                                        <option value="urgent">Urgent</option>
                                                        <option value="low">Low</option>
                                                    </select>
                                                </div>
                                            </div>
                        
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label class="form-label">Start Date</label>
                                                    <input type="date" class="form-control" id="editAnnouncementStartDate">
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">End Date</label>
                                                    <input type="date" class="form-control" id="editAnnouncementEndDate">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-warning" onclick="updateAnnouncement()">
                                            <i class="fas fa-save me-1"></i>Update Announcement
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Marks Tab Content - Section Wise -->
                        <div class="tab-pane fade" id="marks" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h4><i class="fas fa-chart-bar me-2 text-info"></i>Section-wise Exam Results</h4>
                                    <p class="text-muted mb-0">Manage marks and results section-wise</p>
                                </div>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#marksModal">
                                    <i class="fas fa-plus me-2"></i>Enter Marks
                                </button>
                            </div>

                            <!-- Statistics Cards -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card border-primary">
                                        <div class="card-body text-center">
                                            <i class="fas fa-file-alt fa-2x text-primary mb-2"></i>
                                            <h3 class="mb-0" id="totalMarksRecords">0</h3>
                                            <small class="text-muted">Total Records</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-success">
                                        <div class="card-body text-center">
                                            <i class="fas fa-graduation-cap fa-2x text-success mb-2"></i>
                                            <h3 class="mb-0" id="marksCoursesCount">0</h3>
                                            <small class="text-muted">Courses</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-info">
                                        <div class="card-body text-center">
                                            <i class="fas fa-layer-group fa-2x text-info mb-2"></i>
                                            <h3 class="mb-0" id="marksSectionsCount">0</h3>
                                            <small class="text-muted">Sections</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card border-warning">
                                        <div class="card-body text-center">
                                            <i class="fas fa-percentage fa-2x text-warning mb-2"></i>
                                            <h3 class="mb-0" id="avgMarksPercentage">0%</h3>
                                            <small class="text-muted">Average</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters -->
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-3">
                                            <label class="form-label">Filter by Course:</label>
                                            <select class="form-select" id="marksCourseFilter" onchange="filterSectionMarks()">
                                                <option value="">All Courses</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Filter by Section:</label>
                                            <select class="form-select" id="marksSectionFilter" onchange="filterSectionMarks()" disabled>
                                                <option value="">All Sections</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Filter by Exam:</label>
                                            <select class="form-select" id="marksExamFilter" onchange="filterSectionMarks()">
                                                <option value="">All Exams</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Search Student:</label>
                                            <input type="text" class="form-control" id="marksSearch" 
                                                placeholder="Search..." onkeyup="searchSectionMarks()">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Marks Table -->
                            <div class="card">
                                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Marks Records
                                        <span class="badge bg-primary ms-2" id="marksCount">0</span>
                                    </h5>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="refreshSectionMarks()">
                                            <i class="fas fa-sync-alt me-1"></i> Refresh
                                        </button>
                                        <button class="btn btn-sm btn-outline-success ms-2" onclick="exportSectionMarks()">
                                            <i class="fas fa-download me-1"></i> Export
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Exam</th>
                                                    <th>Student</th>
                                                    <th>Course</th>
                                                    <th>Section</th>
                                                    <th>Subject</th>
                                                    <th>Marks</th>
                                                    <th>Percentage</th>
                                                    <th>Grade</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="marksTableBody">
                                                <tr>
                                                    <td colspan="10" class="text-center py-4">
                                                        <i class="fas fa-chart-bar fa-3x text-muted mb-3"></i>
                                                        <p>No marks records found</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- View Marks Details Modal -->
                        <div class="modal fade" id="viewMarksModal" tabindex="-1">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header bg-info text-white">
                                        <h5 class="modal-title">
                                            <i class="fas fa-eye me-2"></i>Marks Details
                                        </h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body" id="viewMarksContent">
                                        <!-- Content will be loaded here -->
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button type="button" class="btn btn-warning" onclick="editFromViewModal()">Edit</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sync Status Indicator -->
    <div id="syncStatus" class="sync-status bg-success text-white">
        <i class="fas fa-check-circle me-2"></i> Data synced with Supabase
    </div>

    <!-- Modals -->
    <!-- Student Modal -->
    <div class="modal fade" id="studentModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="studentModalTitle"><i class="fas fa-user-plus me-2"></i>New Student Admission</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="studentForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Full Name *</label>
                                <input type="text" class="form-control" name="fullName" required placeholder="Enter student's full name">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Parent's Name *</label>
                                <input type="text" class="form-control" name="parentName" required placeholder="Enter parent's full name">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Contact Number *</label>
                                <input type="tel" class="form-control" name="phone" required placeholder="Enter phone number">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Email Address</label>
                                <input type="email" class="form-control" name="email" placeholder="Enter email address">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Select Course *</label>
                                <select class="form-select" name="course" required>
                                    <option value="">Select Course</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Course Fee *</label>
                                <input type="number" class="form-control" name="fee" required placeholder="Enter course fee">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Address</label>
                            <textarea class="form-control" name="address" rows="3" placeholder="Enter complete address"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="studentSaveBtn" onclick="saveStudent()">
                        <i class="fas fa-save me-1"></i> Save Student
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Course Modal -->
    <div class="modal fade" id="courseModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="courseModalTitle"><i class="fas fa-book me-2"></i>Add New Course</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="courseForm">
                        <div class="mb-3">
                            <label class="form-label">Course Name *</label>
                            <input type="text" class="form-control" name="courseName" required placeholder="Enter course name">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Course Code *</label>
                            <input type="text" class="form-control" name="courseCode" required placeholder="Enter course code">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Duration (Months) *</label>
                            <input type="number" class="form-control" name="duration" required min="1" placeholder="Enter duration in months">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Fee Amount (₹) *</label>
                            <input type="number" class="form-control" name="feeAmount" required min="0" placeholder="Enter course fee">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" name="description" rows="3" placeholder="Enter course description"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <select class="form-select" name="category">
                                <option value="computer">Computer Course</option>
                                <option value="academic">Academic</option>
                                <option value="professional">Professional</option>
                                <option value="vocational">Vocational</option>
                            </select>
                        </div>
                        <div class="mb-3 form-check form-switch">
                            <input type="checkbox" class="form-check-input" name="isActive" checked role="switch">
                            <label class="form-check-label">Active Course</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="courseSaveBtn" onclick="saveCourse()">
                        <i class="fas fa-save me-1"></i> Save Course
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fee Modal - Update karo -->
    <div class="modal fade" id="feeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title"><i class="fas fa-money-bill-wave me-2"></i>Record Section Payment</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="feeForm">
                        <!-- Course Filter -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">Select Course *</label>
                            <select class="form-select" id="feeModalCourse" required onchange="loadSectionsForFeeModal()">
                                <option value="">Select Course</option>
                            </select>
                        </div>
                        
                        <!-- Section Selection -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">Select Section *</label>
                            <select class="form-select" id="feeModalSection" required disabled onchange="loadStudentsForFeeModal()">
                                <option value="">-- Select Course First --</option>
                            </select>
                        </div>
                        
                        <!-- Student Dropdown -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">Select Student *</label>
                            <select class="form-select" name="studentId" id="feeModalStudent" required onchange="updateFeeDetails()">
                                <option value="">-- Select Section First --</option>
                            </select>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Total Fee</label>
                                <input type="number" class="form-control" id="totalFee" readonly>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Paid Amount</label>
                                <input type="number" class="form-control" id="paidAmount" readonly>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Due Amount</label>
                                <input type="number" class="form-control" id="dueAmount" readonly>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Amount Paying Now *</label>
                            <input type="number" class="form-control" name="payingNow" id="payingNow" required min="1" placeholder="Enter amount">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Payment Date *</label>
                            <input type="date" class="form-control" name="paymentDate" id="paymentDate" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Payment Mode *</label>
                            <select class="form-select" name="paymentMode" id="paymentMode" required>
                                <option value="">Select Mode</option>
                                <option value="cash">Cash</option>
                                <option value="bank">Bank Transfer</option>
                                <option value="cheque">Cheque</option>
                                <option value="online">Online Payment</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="recordSectionPayment()">
                        <i class="fas fa-receipt me-1"></i> Record Payment
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Teacher Modal -->
    <div class="modal fade" id="teacherModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="teacherModalTitle"><i class="fas fa-user-tie me-2"></i>Add New Teacher</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="teacherForm">
                        <div class="mb-3">
                            <label class="form-label">Full Name *</label>
                            <input type="text" class="form-control" name="fullName" required placeholder="Enter teacher's full name">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Subject/Expertise *</label>
                            <input type="text" class="form-control" name="subject" required placeholder="Enter subject or expertise">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contact Number *</label>
                            <input type="tel" class="form-control" name="phone" required placeholder="Enter phone number">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Email Address</label>
                            <input type="email" class="form-control" name="email" placeholder="Enter email address">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Monthly Salary *</label>
                            <input type="number" class="form-control" name="salary" required placeholder="Enter monthly salary">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Joining Date *</label>
                            <input type="date" class="form-control" name="joiningDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Address</label>
                            <textarea class="form-control" name="address" rows="2" placeholder="Enter address"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="teacherSaveBtn" onclick="saveTeacher()">
                        <i class="fas fa-save me-1"></i> Save Teacher
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Marks Modal - Complete Fixed Version -->
    <div class="modal fade" id="marksModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-edit me-2"></i>Enter Student Marks
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="marksForm">
                        <!-- Exam Details Row -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label">Exam Type *</label>
                                <select class="form-select" id="examType" required>
                                    <option value="">Select Exam</option>
                                    <option value="Mid-Term">Mid-Term</option>
                                    <option value="End-Term">End-Term</option>
                                    <option value="Class Test-1">Class Test-1</option>
                                    <option value="Class Test-2">Class Test-2</option>
                                    <option value="Quiz">Quiz</option>
                                    <option value="Assignment">Assignment</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Exam Date *</label>
                                <input type="date" class="form-control" id="examDate" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Subject *</label>
                                <input type="text" class="form-control" id="marksSubject" required placeholder="e.g., Mathematics">
                            </div>
                        </div>

                        <!-- Course and Section Row -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Select Course *</label>
                                <select class="form-select" id="marksCourse" required onchange="loadSectionsForMarks(this.value)">
                                    <option value="">Select Course</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Select Section *</label>
                                <select class="form-select" id="marksSection" required disabled onchange="loadStudentsForMarks()">
                                    <option value="">Select course first...</option>
                                </select>
                            </div>
                        </div>

                        <!-- Total Marks -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Total Marks *</label>
                                <input type="number" class="form-control" id="totalMarks" value="100" min="1" required>
                            </div>
                        </div>

                        <!-- Hidden edit ID -->
                        <input type="hidden" id="editMarksId">

                        <!-- Students Marks List - IMPORTANT: This element must exist -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-users me-2"></i>Student Marks
                            </label>
                            <div id="marksStudentsList" class="border rounded p-3" 
                                style="max-height: 400px; overflow-y: auto; background: #f8f9fa;">
                                <div class="text-center text-muted py-4">
                                    <i class="fas fa-arrow-up fa-2x mb-2"></i>
                                    <p class="mb-0">Select course and section to load students</p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveSectionMarks()">
                        <i class="fas fa-save me-1"></i> Save Marks
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Attendance Modal - Section Wise - NEW -->
    <div class="modal fade" id="attendanceModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-clipboard-check me-2"></i>
                        Mark Section Attendance
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="attendanceForm">
                        <!-- Course Selection -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-book me-1 text-primary"></i> Select Course *
                                </label>
                                <select class="form-select" id="attendanceCourse" required>
                                    <option value="">-- Choose Course --</option>
                                </select>
                            </div>
                            
                            <!-- Section Selection -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-layer-group me-1 text-success"></i> Select Section *
                                </label>
                                <select class="form-select" id="attendanceSection" required disabled>
                                    <option value="">-- Select Course First --</option>
                                </select>
                            </div>
                        </div>

                        <!-- Date and Subject -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-calendar me-1 text-info"></i> Date *
                                </label>
                                <input type="date" class="form-control" id="attendanceDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-tag me-1 text-warning"></i> Subject
                                </label>
                                <input type="text" class="form-control" id="attendanceSubject" 
                                    placeholder="e.g., Mathematics">
                            </div>
                        </div>

                        <!-- Attendance ID for editing -->
                        <input type="hidden" id="editAttendanceId">

                        <!-- Students List -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-users me-1 text-secondary"></i> Student Attendance
                            </label>
                            <div id="attendanceStudentsList" class="border rounded p-3" 
                                style="max-height: 400px; overflow-y: auto; background: #f8f9fa;">
                                <div class="text-center text-muted py-4">
                                    <i class="fas fa-arrow-up fa-2x mb-2"></i>
                                    <p class="mb-0">Select course and section to load students</p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancel
                    </button>
                    <button type="button" class="btn btn-primary" onclick="saveSectionAttendance()">
                        <i class="fas fa-save me-1"></i> Save Attendance
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Contact Message Modal - Add this at the end of your modals -->
    <div class="modal fade" id="viewContactModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-envelope me-2"></i> Contact Message Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="contactMessageDetails">
                        <!-- Message details will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" onclick="markAsReplied()">
                        <i class="fas fa-reply me-1"></i> Mark as Replied
                    </button>
                    <button type="button" class="btn btn-danger" onclick="deleteCurrentMessage()">
                        <i class="fas fa-trash me-1"></i> Delete
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Notification Modal -->
    <div class="modal fade" id="notificationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-bullhorn me-2"></i>Send Notification</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="notificationForm">
                        <div class="mb-3">
                            <label class="form-label">Title *</label>
                            <input type="text" class="form-control" name="title" required placeholder="Enter notification title">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Message *</label>
                            <textarea class="form-control" name="message" rows="3" required placeholder="Enter notification message"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Audience *</label>
                            <select class="form-select" name="audience" required>
                                <option value="all">All Users</option>
                                <option value="students">Students Only</option>
                                <option value="teachers">Teachers Only</option>
                                <option value="parents">Parents Only</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Priority</label>
                            <select class="form-select" name="priority">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="sendNotification()">
                        <i class="fas fa-paper-plane me-1"></i> Send Notification
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload PDF Modal - Section Wise (FIXED) -->
    <div class="modal fade" id="uploadPdfModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-upload me-2"></i>Upload Section PDF
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="uploadPdfForm">
                        <!-- Course Selection -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-book me-1 text-primary"></i> Select Course *
                                </label>
                                <select class="form-select" id="pdfCourseSelect" required onchange="loadSectionsForPdf()">
                                    <option value="">-- Choose Course --</option>
                                </select>
                            </div>
                            
                            <!-- Section Selection -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-layer-group me-1 text-success"></i> Select Section *
                                </label>
                                <select class="form-select" id="pdfSectionSelect" required disabled>
                                    <option value="">-- Select Course First --</option>
                                </select>
                            </div>
                        </div>

                        <!-- PDF Title -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-heading me-1 text-info"></i> PDF Title *
                            </label>
                            <input type="text" class="form-control" name="pdf_title" 
                                placeholder="e.g., Chapter 1 - Introduction" required>
                        </div>

                        <!-- Description -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-align-left me-1 text-secondary"></i> Description
                            </label>
                            <textarea class="form-control" name="description" rows="3"></textarea>
                        </div>

                        <!-- PDF File -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-file-pdf me-1 text-danger"></i> Select PDF File *
                            </label>
                            <input type="file" class="form-control" name="pdf_file" id="pdfFileInput" accept=".pdf" required>
                            <small class="text-muted">Max: 10MB</small>
                            <div id="filePreview" class="mt-2" style="display: none;">
                                <div class="alert alert-info">
                                    <i class="fas fa-file-pdf me-2"></i>
                                    <strong id="selectedFileName"></strong>
                                    <span class="ms-2">(<span id="selectedFileSize"></span>)</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancel
                    </button>
                    <button type="button" class="btn btn-primary" onclick="saveSectionPdf()">
                        <i class="fas fa-save me-1"></i> Upload PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit PDF Modal -->
    <div class="modal fade" id="editPdfModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title">
                        <i class="fas fa-edit me-2"></i>Edit PDF Details
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editPdfForm">
                        <input type="hidden" id="editPdfId">
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">PDF Title *</label>
                            <input type="text" class="form-control" id="editPdfTitle" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Description</label>
                            <textarea class="form-control" id="editPdfDescription" rows="3"></textarea>
                        </div>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Course and section cannot be edited. Delete and re-upload if needed.
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-warning" onclick="updateSectionPdf()">
                        <i class="fas fa-save me-1"></i> Update
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Syllabus Modal -->
    <div class="modal fade" id="syllabusModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white" id="syllabusModalHeader">
                    <h5 class="modal-title">
                        <i class="fas fa-plus me-2"></i>Add New Syllabus
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="syllabusForm">
                        <input type="hidden" id="editSyllabusId">
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Course *</label>
                                <select class="form-select" id="syllabusCourse" required>
                                    <option value="">Select course...</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Syllabus Title *</label>
                                <input type="text" class="form-control" id="syllabusTitle" 
                                    placeholder="e.g., Complete Course Syllabus" required>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="syllabusDescription" rows="2" 
                                    placeholder="Brief description of the syllabus..."></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Total Duration (Hours) *</label>
                                <input type="number" class="form-control" id="syllabusDuration" 
                                    min="1" max="500" value="40" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="syllabusStatus">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>

                        <!-- Subjects Section -->
                        <div class="card mb-3">
                            <div class="card-header bg-light d-flex justify-content-between align-items-center">
                                <h6 class="mb-0">
                                    <i class="fas fa-list me-2"></i>Subjects & Topics
                                </h6>
                                <button type="button" class="btn btn-sm btn-success" onclick="addSubjectRow()">
                                    <i class="fas fa-plus me-1"></i> Add Subject
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered" id="subjectsTable">
                                        <thead class="table-light">
                                            <tr>
                                                <th width="5%">#</th>
                                                <th width="40%">Subject Name *</th>
                                                <th width="20%">Duration (Hrs)</th>
                                                <th width="30%">Topics</th>
                                                <th width="5%">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="subjectsTableBody">
                                            <!-- Subjects will be added here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="saveSyllabus()">
                        <i class="fas fa-save me-1"></i> Save Syllabus
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div class="modal fade" id="reportModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-file-pdf me-2"></i>Generate Report</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="reportForm">
                        <div class="mb-3">
                            <label class="form-label">Report Type *</label>
                            <select class="form-select" name="reportType" required>
                                <option value="">Select Report Type</option>
                                <option value="students">Students Report</option>
                                <option value="teachers">Teachers Report</option>
                                <option value="courses">Courses Report</option>
                                <option value="fees">Fee Collection Report</option>
                                <option value="attendance">Attendance Report</option>
                                <option value="marks">Exam Results Report</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Start Date</label>
                            <input type="date" class="form-control" name="startDate">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">End Date</label>
                            <input type="date" class="form-control" name="endDate">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Format *</label>
                            <select class="form-select" name="format" required>
                                <option value="csv">CSV</option>
                                <option value="excel">Excel</option>
                                <option value="pdf">PDF</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="generateReport()">
                        <i class="fas fa-download me-1"></i> Generate Report
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Section Modal -->
    <div class="modal fade" id="sectionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white" id="sectionModalHeader">
                    <h5 class="modal-title">
                        <i class="fas fa-plus me-2"></i>Add New Section
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="sectionForm">
                        <input type="hidden" id="editSectionId">
                        
                        <div class="mb-3">
                            <label class="form-label">Course *</label>
                            <select class="form-select" id="sectionCourse" required>
                                <option value="">Select course...</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Section Name *</label>
                            <input type="text" class="form-control" id="sectionName" 
                                placeholder="e.g., A, B, C" required maxlength="10">
                            <small class="text-muted">Single letter recommended</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Maximum Students *</label>
                            <input type="number" class="form-control" id="maxStudents" 
                                min="1" max="100" value="50" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="sectionStatus">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="saveSection()">
                        <i class="fas fa-save me-1"></i>Save Section
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Assign Teacher to Section Modal -->
    <div class="modal fade" id="assignTeacherModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-user-plus me-2"></i>Assign Teacher to Section
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="assignTeacherForm">
                        <div class="mb-3">
                            <label class="form-label">Select Teacher *</label>
                            <select class="form-select" id="assignTeacherId" required>
                                <option value="">Choose teacher...</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Select Course *</label>
                            <select class="form-select" id="assignCourse" required onchange="loadSectionsForAssignment()">
                                <option value="">Choose course...</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Select Section *</label>
                            <select class="form-select" id="assignSectionId" required>
                                <option value="">Select course first...</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Subject</label>
                            <input type="text" class="form-control" id="assignSubject" 
                                placeholder="e.g., Computer Science, Mathematics">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="assignTeacherToSection()">
                        <i class="fas fa-check me-1"></i>Assign Teacher
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Time Table Modal - Updated with Teacher Subject Auto-load -->
    <div class="modal fade" id="timetableModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-plus me-2"></i>Add Timetable Entry
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="timetableForm">
                        <input type="hidden" id="editTimetableId">
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Course *</label>
                                <select class="form-select" id="timetableCourse" required>
                                    <option value="">Select course...</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Day of Week *</label>
                                <select class="form-select" id="timetableDay" required>
                                    <option value="">Select day...</option>
                                    <option value="Monday">Monday</option>
                                    <option value="Tuesday">Tuesday</option>
                                    <option value="Wednesday">Wednesday</option>
                                    <option value="Thursday">Thursday</option>
                                    <option value="Friday">Friday</option>
                                    <option value="Saturday">Saturday</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Start Time *</label>
                                <input type="time" class="form-control" id="timetableStartTime" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">End Time *</label>
                                <input type="time" class="form-control" id="timetableEndTime" required>
                            </div>
                        </div>

                        <!-- Teacher Selection -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Select Teacher *</label>
                                <select class="form-select" id="timetableTeacher" required onchange="loadTeacherSubjectsForTimetable()">
                                    <option value="">Choose teacher...</option>
                                </select>
                            </div>
                            
                            <!-- Subject Selection - Auto loads based on teacher -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Subject *</label>
                                <select class="form-select" id="timetableSubject" required>
                                    <option value="">Select teacher first...</option>
                                </select>
                                <small class="text-muted">Subjects automatically loaded from teacher's assignments</small>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Room Number</label>
                                <input type="text" class="form-control" id="timetableRoom" 
                                    placeholder="e.g., Room 101">
                            </div>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="timetableStatus" checked>
                            <label class="form-check-label" for="timetableStatus">
                                Active
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="saveTimetable()">
                        <i class="fas fa-save me-1"></i> Save Entry
                    </button>
                </div>
            </div>
        </div>
    </div>

   

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Mobile menu functionality
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('mobile-open');
        }

        // Mark all notifications as read
        function markAllNotificationsRead() {
            const notifications = document.querySelectorAll('.notification-item');
            notifications.forEach(notification => {
                notification.style.opacity = '0.7';
            });
            document.getElementById('notificationCount').textContent = '0';
            showSuccess('All notifications marked as read!');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            
            if (window.innerWidth <= 768 && 
                !sidebar.contains(event.target) && 
                !mobileMenuBtn.contains(event.target)) {
                sidebar.classList.remove('mobile-open');
            }
        });

        // Close notifications when clicking outside
        document.addEventListener('click', function(event) {
            const notificationPanel = document.getElementById('notificationPanel');
            const notificationBell = document.querySelector('.notification-bell');
            
            if (!notificationPanel.contains(event.target) && 
                !notificationBell.contains(event.target)) {
                notificationPanel.classList.remove('open');
            }
        });
        
    </script>
    <script src="dashboard-admin.js"></script>
</body>

</html>







